---
import Layout from '~/layouts/Layout.astro'
import PageHeader from '~/components/PageHeader.astro'
import ScrollUpButton from '~/components/ScrollUpButton.astro'

import { Image } from 'astro:assets'
import type { ImageMetadata } from 'astro'
import { LightGallery } from 'astro-lightgallery'

// Import all images from assets/pics directory
const images = import.meta.glob<{ default: ImageMetadata }>('/src/assets/pics/*.jpg', {
  eager: true,
})
const imageList = Object.values(images).map((img) => img.default)
---

<Layout title="Pictures" description="Pictures from various speaking engagements">
  <PageHeader title="Pictures" />

  <article>
    <div class="prose">
      <div class="container">
        <p class="intro">
          Click any image to explore the gallery! Here's a collection of photos from my
          speaking engagements, conferences, and tech community events.
        </p>
      </div>

      <LightGallery
        class="gallery"
        options={{
          thumbnail: true,
          autoplay: true,
          slideShowInterval: 500,
        }}
        addPlugins={['zoom']}
      >
        {
          imageList.map((img, i) => {
            const aspectRatio = img.width / img.height
            const isWide = aspectRatio > 1.5
            const isTall = aspectRatio < 0.7
            const isLarge = aspectRatio > 1.2 && aspectRatio < 1.5

            let imgClass = 'gallery-img'
            if (isLarge) {
              imgClass += ' four-grid-cells'
            } else if (isWide) {
              imgClass += ' wide-image'
            } else if (isTall) {
              imgClass += ' tall-image'
            }

            return (
              <a class={imgClass} href={img.src}>
                <Image src={img} alt={`Image ${i + 1} of ${imageList.length}`} />
              </a>
            )
          })
        }
      </LightGallery>
    </div>
  </article>

  <ScrollUpButton />
</Layout>

<style>
  .container {
    margin: 0 auto;
    max-width: var(--container-5xl);
  }

  .intro {
    font-size: 1.125rem;
    text-align: center;
    color: var(--theme-text-light);
    margin-left: auto;
    margin-right: auto;
    padding-top: 1rem;
  }

  .gallery {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(8rem, 1fr));
    grid-auto-rows: 8rem;
    grid-auto-flow: dense;
    gap: 0.375rem;
  }

  .gallery-img {
    position: relative;
    overflow: hidden;
    border: 0.0625rem solid var(--theme-divider);
    border-radius: 0.25rem;
    transition: transform 0.2s ease;
    display: flex;
    align-items: center;
    justify-content: center;
  }

  .gallery-img:hover {
    transform: scale(1.02);
    z-index: 1;
  }

  .gallery-img :global(img) {
    width: 100%;
    height: 100%;
    object-fit: cover;
    object-position: center;
    display: block;
    border-radius: 0.25rem;
    border-style: none;
    transition: transform 0.2s ease;
    flex-shrink: 0;
  }

  .four-grid-cells {
    grid-row: span 2;
    grid-column: span 2;
  }

  .wide-image {
    grid-column: span 2;
  }

  .tall-image {
    grid-row: span 2;
  }

  /* Responsive breakpoints */
  @media (max-width: 48rem) {
    .gallery {
      grid-template-columns: repeat(auto-fill, minmax(9.375rem, 1fr));
      grid-auto-rows: 9.375rem;
      gap: 0.25rem;
    }

    .four-grid-cells {
      grid-row: span 2;
      grid-column: span 2;
    }
  }

  @media (max-width: 30rem) {
    .gallery {
      grid-template-columns: repeat(2, 1fr);
      grid-auto-rows: 7.5rem;
    }

    .four-grid-cells,
    .wide-image {
      grid-column: span 1;
      grid-row: span 1;
    }
  }
</style>
