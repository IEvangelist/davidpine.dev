---
import { SlideViewer } from './slide-viewer'

export interface Slide {
  id: string
  title: string
  author?: string
  description?: string
  tags?: string[]
  pubDate: Date
  theme: string
  transition: string
}

interface Props {
  slide: Slide
}

const { slide } = Astro.props

function formatDate(date: Date): string {
  return date.toLocaleDateString('en-US', {
    year: 'numeric',
    month: 'short',
    day: 'numeric',
  })
}

// Use markdown format for preview - this is what reveal.js markdown plugin expects
const slideContent = `## ${slide.title}${slide.author ? `\n\n*${slide.author}*` : ''}\n\n${formatDate(slide.pubDate)}`
---

<div
  class="group hover:shadow-lg hover:border-[var(--theme-accent)] transition-all duration-300 cursor-pointer w-full flex flex-col rounded-2xl border border-[var(--theme-separator)] bg-[var(--theme-background)] shadow"
>
  <div
    class="w-full h-48 p-0 relative rounded-2xl overflow-hidden slide-preview"
  >
    <SlideViewer
      content={slideContent}
      theme={slide.theme}
      transition={slide.transition}
      controls={false}
      progress={false}
      preview={true}
      client:load
    />
  </div>
</div>

<style>
  .slide-preview {
    pointer-events: none;
    position: relative;
  }

  .slide-preview :global(.reveal) {
    position: absolute !important;
    top: 0 !important;
    left: 0 !important;
    width: 100% !important;
    height: 100% !important;
  }

  .slide-preview :global(.reveal .slides) {
    position: absolute !important;
    top: 50% !important;
    left: 50% !important;
    transform: translate(-50%, -50%) !important;
    width: 100% !important;
    height: 100% !important;
  }

  .slide-preview :global(.reveal .slides section) {
    padding: 20px !important;
  }
</style>
